clear
%	Obtained from output of Listing C28L2
XT=14990432.9744621;  
YT=1952093.10305573;  
ZT=14469752.1663352;  
XTD=996.773566434768; 
YTD=-14954.8124604715;  
ZTD=17528.1931768263;
TF=1000.;
A=2.0926E7;
GM=1.4077E16;
W=-6.283185/86400.;
T=0.;
H=.001;
S=0.;
T0=0.;
T1=TF;
X0(1)=XT/3280.;
X0(2)=YT/3280.;
X0(3)=ZT/3280.;
X0(4)=XTD/3280.;
X0(5)=YTD/3280.;
X0(6)=ZTD/3280.;
[X1]=KEPLER1(X0,T0,T1);
while T<=TF
 	XTOLD=XT;
	YTOLD=YT;
	ZTOLD=ZT;
	XTDOLD=XTD;
	YTDOLD=YTD;
	ZTDOLD=ZTD;
	STEP=1;
	FLAG=0;
	while STEP<=1
		if FLAG==1
         		STEP=2;
			XT=XT+H*XTD;
			YT=YT+H*YTD;
			ZT=ZT+H*ZTD;
			XTD=XTD+H*XTDD;
			YTD=YTD+H*YTDD;
			ZTD=ZTD+H*ZTDD;
        		T=T+H;
        	end
        	TEMPBOTT=(XT^2+YT^2+ZT^2)^1.5;
		XTDD=-GM*XT/TEMPBOTT;
		YTDD=-GM*YT/TEMPBOTT;
		ZTDD=-GM*ZT/TEMPBOTT;
		FLAG=1;
	end
	FLAG=0;
 	XT=.5*(XTOLD+XT+H*XTD);
 	YT=.5*(YTOLD+YT+H*YTD);
	ZT=.5*(ZTOLD+ZT+H*ZTD);
	XTD=.5*(XTDOLD+XTD+H*XTDD);
 	YTD=.5*(YTDOLD+YTD+H*YTDD);
	ZTD=.5*(ZTDOLD+ZTD+H*ZTDD);
	S=S+H;
	if S>=9.9999
		S=0.;
	end
end
XTKM=XT/3280.;
YTKM=YT/3280.;
ZTKM=ZT/3280.;
XTDKM=XTD/3280.;
YTDKM=YTD/3280.;
ZTDKM=ZTD/3280.;
ERRX=XTKM-X1(1);
ERRY=YTKM-X1(2);
ERRZ=ZTKM-X1(3);
ERRXD=XTDKM-X1(4);
ERRYD=YTDKM-X1(5);
ERRZD=ZTDKM-X1(6);
XTKM
X1(1)
YTKM
X1(2)
ZTKM
X1(3)
XTDKM
X1(4)
YTDKM
X1(5)
ZTDKM
X1(6)
ERRX
ERRY
ERRZ
ERRXD
ERRYD
ERRZD
